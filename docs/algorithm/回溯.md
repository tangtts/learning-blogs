# å›æº¯ç®—æ³•

å›æº¯æ³•ä¹Ÿå¯ä»¥å«åšå›æº¯æœç´¢æ³•ï¼Œå®ƒæ˜¯ä¸€ç§æœç´¢çš„æ–¹å¼ã€‚

**å›æº¯æ˜¯é€’å½’çš„å‰¯äº§å“ï¼Œåªè¦æœ‰é€’å½’å°±ä¼šæœ‰å›æº¯**

## å›æº¯æ³•è§£å†³çš„é—®é¢˜

- ç»„åˆé—®é¢˜ï¼šN ä¸ªæ•°é‡Œé¢æŒ‰ä¸€å®šè§„åˆ™æ‰¾å‡º k ä¸ªæ•°çš„é›†åˆ
- åˆ‡å‰²é—®é¢˜ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰ä¸€å®šè§„åˆ™æœ‰å‡ ç§åˆ‡å‰²æ–¹å¼
- å­é›†é—®é¢˜ï¼šä¸€ä¸ª N ä¸ªæ•°çš„é›†åˆé‡Œæœ‰å¤šå°‘ç¬¦åˆæ¡ä»¶çš„å­é›†
- æ’åˆ—é—®é¢˜ï¼šN ä¸ªæ•°æŒ‰ä¸€å®šè§„åˆ™å…¨æ’åˆ—ï¼Œæœ‰å‡ ç§æ’åˆ—æ–¹å¼
- æ£‹ç›˜é—®é¢˜ï¼šN çš‡åï¼Œè§£æ•°ç‹¬ç­‰ç­‰

:::tip ğŸ”¥ğŸ”¥ğŸ”¥
  **ç»„åˆæ˜¯ä¸å¼ºè°ƒå…ƒç´ é¡ºåºçš„ï¼Œæ’åˆ—æ˜¯å¼ºè°ƒå…ƒç´ é¡ºåºã€‚** 
:::

:::info 
å›æº¯æ³•è§£å†³çš„é—®é¢˜éƒ½å¯ä»¥æŠ½è±¡ä¸º**æ ‘å½¢ç»“æ„**

å› ä¸ºå›æº¯æ³•è§£å†³çš„éƒ½æ˜¯åœ¨é›†åˆä¸­é€’å½’æŸ¥æ‰¾å­é›†ï¼Œ**é›†åˆçš„å¤§å°å°±æ„æˆäº†æ ‘çš„å®½åº¦ï¼Œé€’å½’çš„æ·±åº¦ï¼Œéƒ½æ„æˆçš„æ ‘çš„æ·±åº¦** 
:::

<img src="@img/20210130173631174.png"/>

## ç»„åˆ

> ç»™å®šä¸¤ä¸ªæ•´æ•° n å’Œ kï¼Œè¿”å› 1 ... n ä¸­æ‰€æœ‰å¯èƒ½çš„ k ä¸ªæ•°çš„ç»„åˆã€‚  
> ç¤ºä¾‹: è¾“å…¥: n = 4, k = 2 è¾“å‡º: [ [2,4], [3,4], [2,3], [1,2], [1,3], [1,4]]

<img src="@img/20201123195223940.png"/>

æ¯æ¬¡ä»é›†åˆä¸­é€‰å–å…ƒç´ ï¼Œå¯é€‰æ‹©çš„èŒƒå›´éšç€é€‰æ‹©çš„è¿›è¡Œè€Œæ”¶ç¼©ï¼Œ*è°ƒæ•´å¯é€‰æ‹©çš„èŒƒå›´*ã€‚  
å›¾ä¸­å¯ä»¥å‘ç° n ç›¸å½“äºæ ‘çš„å®½åº¦ï¼Œk ç›¸å½“äºæ ‘çš„æ·±åº¦  
å›¾ä¸­æ¯æ¬¡æœç´¢åˆ°äº†å¶å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†ä¸€ä¸ªç»“æœã€‚

### å‰ªæä¼˜åŒ–

**å¦‚æœ for å¾ªç¯é€‰æ‹©çš„èµ·å§‹ä½ç½®ä¹‹åçš„å…ƒç´ ä¸ªæ•° å·²ç»ä¸è¶³ æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ä¸ªæ•°äº†ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦æœç´¢äº†ã€‚**

```txt
for (int i = startIndex; i <= n; i++) {
```

1. å·²ç»é€‰æ‹©çš„å…ƒç´ ä¸ªæ•°ï¼špath.size();

2. è¿˜éœ€è¦çš„å…ƒç´ ä¸ªæ•°ä¸º: k - path.size();

3. åœ¨é›†åˆ n ä¸­è‡³å¤šè¦ä»è¯¥èµ·å§‹ä½ç½® : n - (k - path.size()) + 1ï¼Œå¼€å§‹éå†

ä¸ºä»€ä¹ˆæœ‰ä¸ª+1 å‘¢ï¼Œå› ä¸ºåŒ…æ‹¬èµ·å§‹ä½ç½®ï¼Œæˆ‘ä»¬è¦æ˜¯ä¸€ä¸ªå·¦é—­çš„é›†åˆã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œn = 4ï¼Œk = 3ï¼Œ ç›®å‰å·²ç»é€‰å–çš„å…ƒç´ ä¸º 0ï¼ˆpath.size ä¸º 0ï¼‰ï¼Œn - (k - 0) + 1 å³ 4 - ( 3 - 0) + 1 = 2ã€‚æ‰€ä»¥ä¼˜åŒ–ä¹‹åçš„ for å¾ªç¯æ˜¯

```txt
for (int i = startIndex; i <= n - (k - path.size()) + 1; i++) // iä¸ºæœ¬æ¬¡æœç´¢çš„èµ·å§‹ä½ç½®
```

```js
  function backtrace(num,k){
  let t = [],r = [];
    function combineHelper (i){
      if(t.length == k){
        r.push([...t])
        return
      }
      //å‰ªæ
      for(;i<num - k - t.length + 1){ //[!code ++]
      // æœªå‡æ
      for(;i<=num;i++){ //[!code --]
        t.push(i);
        combineHelper (i+1)
        t.pop()
      }
    }
    combineHelper (1)
  return r
}
let r = backtrace(num,k)
```

## ç»„åˆæ€»å’ŒIII 
> æ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸º n çš„ k ä¸ªæ•°çš„ç»„åˆã€‚ç»„åˆä¸­åªå…è®¸å«æœ‰ 1 - 9 çš„æ­£æ•´æ•°ï¼Œå¹¶ä¸”æ¯ç§ç»„åˆä¸­ä¸å­˜åœ¨é‡å¤çš„æ•°å­—ã€‚

>æ‰€æœ‰æ•°å­—éƒ½æ˜¯æ­£æ•´æ•°ã€‚
>è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚
> - ç¤ºä¾‹ 1: è¾“å…¥: k = 3, n = 7 è¾“å‡º: [[1,2,4]]
> - ç¤ºä¾‹ 2: è¾“å…¥: k = 3, n = 9 è¾“å‡º: [[1,2,6], [1,3,5], [2,3,4]]

```js
let k = 2,n = 4;

function backtrace(n, k) {
  let t = [],r = [],total = 0;

  function combineHelper(startIndex) {
    if(total>n)return;

    if (t.length == k) {
      if (total == n) {
        r.push([...t]);
      }
    }
    // é™å®šåœ¨ 9 - total é‡Œé¢
    for (; startIndex <= 9 - total; startIndex++) {
      t.push(startIndex);
      total += startIndex;
      combineHelper(startIndex + 1);
      total -= t.pop();
    }
  }
  combineHelper(1);
  return r;
}
let r = backtrace(n,k)
```

## ç»„åˆæ€»å’Œ

>ç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•° target ï¼Œæ‰¾å‡º candidates ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º target çš„ç»„åˆã€‚

>candidates ä¸­çš„æ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–ã€‚
>æ‰€æœ‰æ•°å­—ï¼ˆåŒ…æ‹¬ targetï¼‰éƒ½æ˜¯æ­£æ•´æ•°ã€‚
> è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚
> 1. ç¤ºä¾‹ 1ï¼š
>è¾“å…¥ï¼šcandidates = [2,3,6,7], target = 7,
>æ‰€æ±‚è§£é›†ä¸ºï¼š [ [7], [2,2,3] ]
> 2. ç¤ºä¾‹ 2ï¼š
> è¾“å…¥ï¼šcandidates = [2,3,5], target = 8,
> æ‰€æ±‚è§£é›†ä¸ºï¼š [ [2,2,2,2], [2,3,3], [3,5] 

æ ¸å¿ƒé—®é¢˜åœ¨äºæ— é™åˆ¶é‡å¤é€‰å–,è§£é›†ä¸­ä¸èƒ½æœ‰é‡å¤çš„ç»„åˆ,  
æ‰€ä»¥ç”±äºæ˜¯æ— é™åˆ¶é‡å¤é€‰å–ï¼Œå¼€å§‹ä½ç½®ä½¿ç”¨ `i`ï¼Œè€Œä¸æ˜¯ `i+1`

```js
function backtrace(nums, target) {
  let t = [],
    r = [],
    total = 0;
  function combineHelper(startIndex) {
    if (total == target) {
      r.push([...t]);
      return;
    }

    for (let i = startIndex; i < nums.length; i++) { // [!code focus]
      if(nums[i] > target - total) break;
      t.push(nums[i]);
      total += nums[i];
      combineHelper(i); // [!code focus]
      total -= t.pop();
    }
  }
  combineHelper(0);
  return r;
}
let r = backtrace(nums, target);
```

## ç»„åˆæ€»å’ŒII
> ç»™å®šä¸€ä¸ªæ•°ç»„ candidates å’Œä¸€ä¸ªç›®æ ‡æ•° target ï¼Œæ‰¾å‡º candidates ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º target çš„ç»„åˆã€‚
>

> candidates ä¸­çš„æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚
> è¯´æ˜ï¼š æ‰€æœ‰æ•°å­—ï¼ˆåŒ…æ‹¬ç›®æ ‡æ•°ï¼‰éƒ½æ˜¯æ­£æ•´æ•°ã€‚è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚
> 1. è¾“å…¥: candidates = [10,1,2,7,6,1,5], target = 8; è¾“å‡º: [
>    [1, 7],
>    [1, 2, 5],
>    [2, 6],
>    [1, 1, 6]
>  ]

:::tip ğŸ”¥ğŸ”¥ğŸ”¥
  **used[i - 1] == trueï¼Œè¯´æ˜åŒä¸€æ ‘æcandidates[i - 1]ä½¿ç”¨è¿‡  
  used[i - 1] == falseï¼Œè¯´æ˜åŒä¸€æ ‘å±‚candidates[i - 1]ä½¿ç”¨è¿‡** 


  å› ä¸ºåŒä¸€æ ‘å±‚ï¼Œused[i - 1] == false æ‰èƒ½è¡¨ç¤ºï¼Œå½“å‰å–çš„ candidates[i] æ˜¯ä» candidates[i - 1] å›æº¯è€Œæ¥çš„ã€‚  

  è€Œ used[i - 1] == trueï¼Œè¯´æ˜æ˜¯è¿›å…¥ä¸‹ä¸€å±‚é€’å½’ï¼Œå»ä¸‹ä¸€ä¸ªæ•°ï¼Œæ‰€ä»¥æ˜¯æ ‘æä¸Š
:::

<img src="@img/20221021163812.png" />

```js
let nums = [10,1,2,7,6,1,5], target = 8;

function backtrace(nums){
  // å…ˆè¦æ’åº
  nums = nums.sort((a,b)=>a-b)

  let r = [],t = [],total = 0,used = new Array(nums.length).fill(false);
  function helper(startIndex){
    if(total == target){
      r.push([...t])
      return
    }

    for(let i = startIndex;i<nums.length;i++){
      // å¦‚æœä¸åŠ  !used[i-1],ä¼šå¤±å» [1,1,6]
      if(!used[i-1] && i > 0 && nums[i] == nums[i-1] ) continue;

      used[i] = true
      total+=nums[i]
      t.push(nums[i]);
      helper(i+1)
      total-= t.pop()
      used[i] = false
    }
  }
  helper(0)
  return r
}
let r =  backtrace(nums,target)
```


## å­é›†

> ç»™å®šä¸€ç»„ä¸å«é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚ 
  
> è¯´æ˜ï¼šè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„å­é›†ã€‚  
> ç¤ºä¾‹: è¾“å…¥: nums = [1,2,3] è¾“å‡º: [ [3],   [1],   [2],   [1,2,3],   [1,3],   [2,3],   [1,2],   [] ]

**æ±‚å–å­é›†é—®é¢˜ï¼Œä¸éœ€è¦ä»»ä½•å‰ªæï¼å› ä¸ºå­é›†å°±æ˜¯è¦éå†æ•´æ£µæ ‘ã€‚**

<img src="@img/78.å­é›†.png" />

```js
var subsets = function(nums) {
    let result = []
    let path = []
    function backtracking(startIndex) {
        result.push([...path])
        for(let i = startIndex; i < nums.length; i++) {
            path.push(nums[i])
            backtracking(i + 1)
            path.pop()
        }
    }
    backtracking(0)
    return result
}
```
## å­é›†II

> ç»™å®šä¸€ä¸ªå¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰
  
> è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„å­é›†    
> è¾“å…¥:[1,2,2]ï¼Œè¾“å‡º: [ [2], [1], [1,2,2], [2,2], [1,2], [ ] ]

ä½¿ç”¨ `used` æ•°ç»„è®°å½•ä½¿ç”¨è¿‡çš„å…ƒç´ ,ä¹Ÿå¯ä»¥ä½¿ç”¨`i > startIndex  && nums[i] == nums[i-1] `ç®€å•çš„åˆ¤æ–­  

```js
let nums = [1,2,2];

function backtrace(nums){
  nums = nums.sort((a,b)=>a-b)
  let r = [],t = [],used = new Array(nums.length).fill(false);

  function helper(startIndex){
    r.push([...t])
    for(let i = startIndex;i<nums.length;i++){
        // if(!used[i-1] && i > 0 && nums[i] == nums[i-1] ) continue;
        if(i > startIndex && nums[i] == nums[i-1] ) continue;
        used[i] = true
        t.push(nums[i]);
        helper(i+1)
        t.pop()
        used[i] = false
    }
  }
  
  helper(0)
  return r
}
```

## é€’å¢å­åºåˆ—
> ç»™å®šä¸€ä¸ªæ•´å‹æ•°ç»„, ä½ çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°æ‰€æœ‰è¯¥æ•°ç»„çš„é€’å¢å­åºåˆ—ï¼Œé€’å¢å­åºåˆ—çš„é•¿åº¦è‡³å°‘æ˜¯2ã€‚  
> è¾“å…¥: [4, 6, 7, 7],è¾“å‡º: [[4, 6], [4, 7], [4, 6, 7], [4, 6, 7, 7], [6, 7], [6, 7, 7], [7,7], [4,7,7]]

<img src="@img/20201124200229824-20230310131640070.png" />

åœ¨å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ***åŒä¸€çˆ¶èŠ‚ç‚¹ä¸‹çš„åŒå±‚ä¸Šä½¿ç”¨è¿‡çš„å…ƒç´ å°±ä¸èƒ½å†ä½¿ç”¨äº†***

```js
let nums = [4, 6, 7, 7];

function backtrace(nums){
  let r = [],t = [];
  
  function helper(startIndex){
    if(t.length>=2){
        r.push([...t])
    }

    // åªè®°å½•æœ¬å±‚å…ƒç´ æ˜¯å¦é‡å¤ä½¿ç”¨ï¼Œæ–°çš„ä¸€å±‚ä¼šè¢«é‡æ–°å®šä¹‰(æ¸…ç©º)
    let userd = []
    for(let i = startIndex;i<nums.length;i++){
      if((t.length>0 && nums[i] < t[t.length - 1]) || userd[nums[i]]){
          continue;
        }   
        userd[nums[i]] = true
        t.push(nums[i]);
        helper(i+1)
        t.pop()
      }
  }
  
  helper(0)
  return r
}
let r =  backtrace(nums)
```
## å…¨æ’åˆ—
> ç»™å®šä¸€ä¸ª æ²¡æœ‰é‡å¤ æ•°å­—çš„åºåˆ—ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚  
 
> è¾“å…¥: [1,2,3]ï¼Œè¾“å‡ºï¼š[ [1,2,3], [1,3,2], [2,1,3], [2,3,1], [3,1,2], [3,2,1] ]


:::info
  è¿™ä¸ªä¸èƒ½è®¾ç½®èµ·å§‹ç´¢å¼•,å› ä¸ºæœ‰ `[3,1,2]`è¿™ç§  
  åŒæ—¶è¦æ±‚ä¸èƒ½æœ‰é‡å¤,æ‰€ä»¥ä½¿ç”¨ **`userd`** è¿›è¡Œæ”¶é›† ***åŒä¸€ä¸ªæ ‘æä¸Šçš„é‡å¤é¡¹***
:::

<img src="@img/20201209174225145.png"/>

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨åŒä¸€æ ‘æä¸­ä¸éœ€è¦æ”¶é›†å·²ç»ç”¨è¿‡çš„
```js
let nums = [1,2,3];

function backtrace(nums){
  let r = [],t = [],userd = new Array(nums.length).fill(false);

    function helper(){
      if(t.length==nums.length){
        r.push([...t])
        return
      }

      for(let i = 0;i<nums.length;i++){
        // åˆ é™¤å½“å‰æ ‘æä¸­å·²ç»ç”¨è¿‡çš„
        if(userd[i])continue //[!code ++]
        userd[i] = true
        t.push(nums[i]);
        helper()
        t.pop()
        userd[i] = false
      }
  }
  
  helper(0)
  return r
}
```

## å…¨æ’åˆ— II
> ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— nums ï¼ŒæŒ‰ä»»æ„é¡ºåº è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚  

> 1. è¾“å…¥:nums = [1,1,2]ï¼Œè¾“å‡ºï¼š[[1,1,2], [1,2,1], [2,1,1]]  
> 2. è¾“å…¥:nums = [1,2,3]ï¼Œè¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]

è¿™é“é¢˜ç›®å’Œå…¨æ’åˆ—çš„åŒºåˆ«åœ¨ä¸ç»™å®šä¸€ä¸ª**å¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ—ï¼Œè¦è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—**ã€‚  

**å¼ºè°ƒçš„æ˜¯å»é‡ä¸€å®šè¦å¯¹å…ƒç´ è¿›è¡Œæ’åºï¼Œè¿™æ ·æˆ‘ä»¬æ‰æ–¹ä¾¿é€šè¿‡ç›¸é‚»çš„èŠ‚ç‚¹æ¥åˆ¤æ–­æ˜¯å¦é‡å¤ä½¿ç”¨äº†ã€‚**

 <img src="@img/20201124201406192.png" />

å›¾ä¸­æˆ‘ä»¬å¯¹åŒä¸€æ ‘å±‚ï¼Œå‰ä¸€ä½ï¼ˆä¹Ÿå°±æ˜¯nums[i-1]ï¼‰å¦‚æœä½¿ç”¨è¿‡ï¼Œé‚£ä¹ˆå°±è¿›è¡Œå»é‡ã€‚

```js
let nums = [1, 1, 2];

function backtrace(nums) {
  let r = [],
    t = [],
    used = new Array(nums.length).fill(false);

  function helper() {
    if (t.length == nums.length) {
      r.push([...t]);
      return;
    }

    for (let i = 0; i < nums.length; i++) {
      // åŒä¸€æ ‘å±‚ä¸‹ä¸èƒ½å–ç›¸åŒçš„
      if (i > 0 && nums[i] == nums[i - 1] && !used[i-1]) continue;
      // å› ä¸ºæ˜¯å¯ä»¥é‡å¤é€‰å–,æ‰€ä»¥è¦æŠŠè‡ªå·±ç»™æ’é™¤æ‰
      if(used[i]) continue
    
        used[i] = true;
        t.push(nums[i]);
        helper();
        t.pop();
        used[i] = false;
      
    }
  }

  helper(0);
  return r;
}
let r = backtrace(nums);
```
## [å›æº¯æ€»ç»“](https://www.programmercarl.com/%E5%9B%9E%E6%BA%AF%E6%80%BB%E7%BB%93.html#%E7%BB%84%E5%90%88%E9%97%AE%E9%A2%98)

æ·±åˆ»ç†è§£ä¸‹é¢çš„è¿™å¼ å›¾
<img src="@img/20201112170304979.png">
