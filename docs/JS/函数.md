# å‡½æ•°
å…³äºå‡½æ•°çš„ä¸€åˆ‡,å‡½æ•°å®šä¹‰,å±æ€§,å¸¸ç”¨çš„å‡½æ•°ç¼–ç¨‹...
## ä½œç”¨åŸŸ
:::tip
 åªæœ‰åœ¨å‡½æ•°ä¸­æœ‰ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œåœ¨`if/for` ä¸­æ²¡æœ‰ä½œç”¨åŸŸçš„æ¦‚å¿µ
:::
### å—çº§ä½œç”¨åŸŸ
 åœ¨ `js` ä¸­ï¼Œ`{}` ä¸ä»…ä»£è¡¨äº†å¯¹è±¡å­—é¢é‡ï¼Œä¹Ÿä»£è¡¨äº† ***ä»£ç å—*** 

`let` åˆ›å»ºå—çº§ä½œç”¨åŸŸçš„æ„æ€æ˜¯ä»¥ `{}`åŒ…è£¹å¯ä»¥å½¢æˆä¸€ä¸ªä»£ç å—ï¼Œæ¯”å¦‚ `if/for`, letåœ¨è¯¥ä»£ç å—ä¸­æœ‰æ•ˆ

 ### é™æ€ä½œç”¨åŸŸ
 åœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™ï¼Œå¸¦äº†ä¸€ä¸ª[[scope]]çš„å±æ€§,åŒ…å«ç€åˆ›å»ºæ—¶çš„è¯æ³•ç¯å¢ƒ; åœ¨å‡½æ•°åˆ›å»ºå·²ç»ç¡®å®šå¥½äº†å‡½æ•°çš„é™æ€ä½œç”¨åŸŸäº†  
 æ¯”å¦‚ `ä½ æ˜¯ä¸€ä¸ªæ²³å—äºº,åœ¨å‡ºç”Ÿçš„æ—¶å€™å·²ç»ç¡®å®šäº†,æœ‰äº›ä¸œè¥¿ä¸è®ºå¸¦åˆ°å“ªé‡Œéƒ½å»ä¸æ‰`

### åŠ¨æ€ä½œç”¨åŸŸ
:::tip
ç‰¹æŒ‡ `this`,å¯ä»¥æ ¹æ®è°ƒç”¨æ–¹çš„ä¸åŒï¼Œåˆ‡æ¢ä¸åŒçš„æ‰§è¡Œç¯å¢ƒ  
ç®­å¤´å‡½æ•°åœ¨åˆ›å»ºæ—¶å€™å°±å·²ç»ç¡®å®š`this`æŒ‡å‘,ã€Šå¼€å¢™é€ç»¿ã€‹

å›è°ƒå‡½æ•°ä¸­çš„ `this` æŒ‡å‘ window
:::
```js
var name = 1;

var obj1 = {
	name:2,
	fn1:function(){
		console.log(this.name);
	},

	fn2:()=>console.log(this.name),

	fn3:function(){
		return function(){
			console.log(this.name)
		}
	},

	fn4:function(){
		// å’Œ fn4 çš„ this ä¿æŒä¸€è‡´ 
		return ()=>{
			console.log(this.name)
		}
	},
}

let obj2 ={
	name:3
}

// å‡½æ•° åœ¨ å †å†…å­˜é‡Œå­˜å‚¨ 
// fn1 -> æŒ‡å‘ä¸€ä¸ªåœ°å€ï¼Œ è¿™ä¸ªåœ°å€ æŒ‡å‘ è¿™ä¸ªå‡½æ•°åœ°å€
// æ‰€ä»¥å¯ä»¥åœ¨å…¶ä»–è°ƒç”¨ç¯å¢ƒä¸­æ‰§è¡Œ
// å…¶å®this æŒ‡å‘çš„ æ‰§è¡Œç¯å¢ƒ

obj1.fn1() // 2
obj1.fn1.call(obj2) // 3
obj1.fn2() // 1
obj1.fn2.call(obj2) // 1
obj1.fn3()() // 1
obj1.fn3.call(obj2)() // 1

obj1.fn4()() // 2
obj1.fn4.call(obj2)() // 3
```


## é—­åŒ…
:::tip
å‡½æ•°çš„å®šä¹‰å’Œæ‰§è¡Œä¸åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œå«åšé—­åŒ… 
ä»¥å‰çš„å®šä¹‰æ˜¯ å¤–å±‚å‡½æ•°å¼•ç”¨å†…éƒ¨å˜é‡,å¯¼è‡´å†…éƒ¨å˜é‡æ— æ³•é‡Šæ”¾
:::
```js
function after(times,callback){
 return function(){
   if(--times){
    callback()
  }
 } 
}

let cb = atfter(2,function(){
  console.log(11)
})
```

## å‡½æ•°ç§‘é‡ŒåŒ–

:::tip
ç§‘é‡ŒåŒ–ï¼ˆCurryingï¼‰æ˜¯ä¸€ç§å°†æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢æˆä¸€ç³»åˆ—åªæ¥å— å•ä¸ªå‚æ•° çš„å‡½æ•°çš„æŠ€æœ¯  
å¦‚æœæ˜¯ å¤šä¸ªå‚æ•°ï¼Œå« åå‡½æ•°, å…ˆå›ºå®šéƒ¨åˆ†å‚æ•°ï¼Œä¹‹åå†ä¼ å…¥å…¶ä»–å‚æ•°  
sum( 1, 2 )( 3 )è¿™ç§å«åå‡½æ•°  
sum( 1 )( 2 )( 3 ) è¿™ç§å«ç§‘é‡ŒåŒ–	
:::

å…¶å®æ˜¯åˆ©ç”¨äº† é—­åŒ… æ•ˆæœå¯¹å‚æ•°è¿›è¡Œäº†ç¼“å­˜
```js
function add(a,b,c){
	return a+b+c
}

function curry(fn){
	// è·å–å½¢å‚çš„é•¿åº¦
	let length = fn.length;
	return function c(...args){
		if(args.length < length){
			return (...rest)=> c(...rest,...args)
		}
		return  fn(...args)
	}
}

let c = curry(add)
console.log("ğŸš€ ~ file: index.js ~ line 78 ~ c(1,2,3)", c(1,2,3));
console.log("ğŸš€ ~ file: index.js ~ line 79 ~ c(1)(2,3)", c(1)(2,3));
console.log("ğŸš€ ~ file: index.js ~ line 80 ~ c()(1,2,3)", c()(1,2,3));
```
## ç®¡é“
fns å¦‚æœåªæœ‰ä¸€é¡¹çš„è¯ï¼Œæ˜¯ä¼šåŸè·¯è¿”å›ï¼Œä¸ä¼šæ‰§è¡Œ reduceæ–¹æ³•

```js
	function add1(a) {
  return a + 1
}
function add2(a) {
  return a + 2
}
function add3(a) {
  return a + 3
}


function pipe(...fns){
  // ä»å³åˆ°å·¦æ‰§è¡Œ
  // 1. a æ˜¯ add1,b æ˜¯ add2, è¿”å›ä¸€ä¸ª (...args)=> add1(add2(...args))
  // 2. a æ˜¯ (...args)=> add1(add2(...args)), b æ˜¯ add3, (...args)=> add1(add2(add3(args)))  

  let res = fns.reduceRight((a,b)=>{
    return (...args) => a(b(...args))
  });
  return res
}
let fn =  pipe(add1,add2,add3)
let res = fn("abcd")
let fn2 =  pipe(add1)
let res2 = fn2(10) // 11
```
## pointFree(æ— æŒ‡å‘)
## å°¾é€’å½’
å°¾é€’å½’çš„è¦æ±‚æ˜¯é€’å½’ return æ˜¯ä¸€ä¸ªå‡½æ•°, `return fn() + 1` ä¸èƒ½ç®—æ˜¯ä¸€ä¸ªå°¾é€’å½’
```js
function factorial(n, total = 1) { 
  if (n === 1) return total;
  return factorial(n - 1, n * total);
}
factorial(5) // 120
```

```js
// è¿™é“é¢˜æœ‰ä¸ªè§„å¾‹ï¼Œç¬¬ä¸€é¡¹åŠ ä¸Šç¬¬äºŒé¡¹æ°¸è¿œç­‰äºç¬¬ä¸‰é¡¹ï¼š
// 1 + 1 = 2ï¼›1 + 2 = 3ï¼›2 + 3  // = 5ï¼›3 + 5 = 8 ....

// å€’åºç›¸åŠ 
function factorial(n) {
  // ç¬¬ä¸€é¡¹å’Œç¬¬äºŒé¡¹éƒ½è¿”å›1
  if (n === 1 || n === 2) return 1;
  // æˆ‘ä»¬åªè¦è¿”å› n - 1ï¼ˆnçš„å‰ä¸€é¡¹ï¼‰ä¸ n - 2ï¼ˆnçš„å‰ä¸¤é¡¹ï¼‰çš„å’Œä¾¿æ˜¯æˆ‘ä»¬è¦çš„å€¼
  return factorial(n - 1) + factorial(n - 2);
}


function factorial(n, sum1 = 1, sum2 = 1) { // æ±‚æœ€ç»ˆçš„å€¼ï¼Œä¸æ˜¯æ±‚å’Œ
  if (n === 1 || n === 2) return sum2;
  return factorial(n - 1, sum2, sum1 + sum2);
}
```